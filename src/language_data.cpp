#include "language_data.h"
#include <fstream>
#include <sstream>
#include <cstring>

using namespace std;

namespace LanguageData
{	
	double EnglishIoC = 0.0665;
	double EnglishDIoC = 0.0075;
	double EnglishChi2 = 0.55;
	double EnglishEntropy = 4.1;
	
	CharToDoubleMap expectedLetters = {
		{'A', 0.08167},
		{'B', 0.01492},
		{'C', 0.02782},
		{'D', 0.04253},
		{'E', 0.12702},
		{'F', 0.02228},
		{'G', 0.02015},
		{'H', 0.06094},
		{'I', 0.06966},
		{'J', 0.00153},
		{'K', 0.00772},
		{'L', 0.04025},
		{'M', 0.02406},
		{'N', 0.06749},
		{'O', 0.07507},
		{'P', 0.01929},
		{'Q', 0.00095},
		{'R', 0.05987},
		{'S', 0.06327},
		{'T', 0.09056},
		{'U', 0.02758},
		{'V', 0.00978},
		{'W', 0.02360},
		{'X', 0.00150},
		{'Y', 0.01974},
		{'Z', 0.00074}
	};
	
	StringToIntMap expectedBigrams = {
	  {"AA", 69},
	  {"AB", 95},
	  {"AC", 101},
	  {"AD", 104},
	  {"AE", 62},
	  {"AF", 89},
	  {"AG", 95},
	  {"AH", 79},
	  {"AI", 102},
	  {"AJ", 63},
	  {"AK", 90},
	  {"AL", 107},
	  {"AM", 98},
	  {"AN", 117},
	  {"AO", 64},
	  {"AP", 96},
	  {"AQ", 60},
	  {"AR", 110},
	  {"AS", 111},
	  {"AT", 113},
	  {"AU", 91},
	  {"AV", 97},
	  {"AW", 90},
	  {"AX", 55},
	  {"AY", 96},
	  {"AZ", 70},
	  {"BA", 91},
	  {"BB", 68},
	  {"BC", 36},
	  {"BD", 45},
	  {"BE", 105},
	  {"BF", 32},
	  {"BG", 23},
	  {"BH", 51},
	  {"BI", 82},
	  {"BJ", 65},
	  {"BK", 6},
	  {"BL", 95},
	  {"BM", 52},
	  {"BN", 39},
	  {"BO", 94},
	  {"BP", 24},
	  {"BR", 89},
	  {"BS", 75},
	  {"BT", 68},
	  {"BU", 96},
	  {"BV", 46},
	  {"BW", 45},
	  {"BY", 89},
	  {"CA", 99},
	  {"CB", 46},
	  {"CC", 82},
	  {"CD", 48},
	  {"CE", 103},
	  {"CF", 47},
	  {"CG", 40},
	  {"CH", 104},
	  {"CI", 90},
	  {"CJ", 27},
	  {"CK", 91},
	  {"CL", 88},
	  {"CM", 46},
	  {"CN", 41},
	  {"CO", 105},
	  {"CP", 52},
	  {"CQ", 61},
	  {"CR", 88},
	  {"CS", 66},
	  {"CT", 94},
	  {"CU", 86},
	  {"CV", 31},
	  {"CW", 52},
	  {"CY", 69},
	  {"CZ", 20},
	  {"DA", 104},
	  {"DB", 95},
	  {"DC", 86},
	  {"DD", 90},
	  {"DE", 106},
	  {"DF", 90},
	  {"DG", 85},
	  {"DH", 99},
	  {"DI", 105},
	  {"DJ", 76},
	  {"DK", 69},
	  {"DL", 90},
	  {"DM", 90},
	  {"DN", 93},
	  {"DO", 102},
	  {"DP", 86},
	  {"DQ", 61},
	  {"DR", 94},
	  {"DS", 99},
	  {"DT", 106},
	  {"DU", 87},
	  {"DV", 75},
	  {"DW", 95},
	  {"DY", 86},
	  {"DZ", 38},
	  {"EA", 112},
	  {"EB", 97},
	  {"EC", 104},
	  {"ED", 114},
	  {"EE", 104},
	  {"EF", 100},
	  {"EG", 95},
	  {"EH", 102},
	  {"EI", 103},
	  {"EJ", 74},
	  {"EK", 80},
	  {"EL", 106},
	  {"EM", 104},
	  {"EN", 113},
	  {"EO", 101},
	  {"EP", 100},
	  {"EQ", 75},
	  {"ER", 118},
	  {"ES", 113},
	  {"ET", 110},
	  {"EU", 84},
	  {"EV", 98},
	  {"EW", 104},
	  {"EX", 90},
	  {"EY", 96},
	  {"EZ", 59},
	  {"FA", 98},
	  {"FB", 75},
	  {"FC", 76},
	  {"FD", 71},
	  {"FE", 96},
	  {"FF", 90},
	  {"FG", 68},
	  {"FH", 87},
	  {"FI", 97},
	  {"FJ", 62},
	  {"FK", 53},
	  {"FL", 86},
	  {"FM", 79},
	  {"FN", 66},
	  {"FO", 102},
	  {"FP", 75},
	  {"FQ", 38},
	  {"FR", 96},
	  {"FS", 81},
	  {"FT", 101},
	  {"FU", 87},
	  {"FV", 61},
	  {"FW", 79},
	  {"FY", 73},
	  {"FZ", 27},
	  {"GA", 98},
	  {"GB", 78},
	  {"GC", 72},
	  {"GD", 72},
	  {"GE", 98},
	  {"GF", 77},
	  {"GG", 77},
	  {"GH", 101},
	  {"GI", 93},
	  {"GJ", 54},
	  {"GK", 47},
	  {"GL", 87},
	  {"GM", 77},
	  {"GN", 82},
	  {"GO", 96},
	  {"GP", 72},
	  {"GQ", 44},
	  {"GR", 93},
	  {"GS", 87},
	  {"GT", 94},
	  {"GU", 85},
	  {"GV", 56},
	  {"GW", 82},
	  {"GY", 66},
	  {"GZ", 29},
	  {"HA", 114},
	  {"HB", 75},
	  {"HC", 74},
	  {"HD", 70},
	  {"HE", 123},
	  {"HF", 73},
	  {"HG", 65},
	  {"HH", 87},
	  {"HI", 112},
	  {"HJ", 52},
	  {"HK", 54},
	  {"HL", 72},
	  {"HM", 78},
	  {"HN", 71},
	  {"HO", 106},
	  {"HP", 70},
	  {"HQ", 44},
	  {"HR", 86},
	  {"HS", 82},
	  {"HT", 99},
	  {"HU", 86},
	  {"HV", 55},
	  {"HW", 83},
	  {"HY", 80},
	  {"HZ", 23},
	  {"IA", 91},
	  {"IB", 84},
	  {"IC", 102},
	  {"ID", 101},
	  {"IE", 100},
	  {"IF", 92},
	  {"IG", 96},
	  {"IH", 78},
	  {"II", 61},
	  {"IJ", 43},
	  {"IK", 84},
	  {"IL", 101},
	  {"IM", 101},
	  {"IN", 118},
	  {"IO", 99},
	  {"IP", 80},
	  {"IQ", 54},
	  {"IR", 98},
	  {"IS", 111},
	  {"IT", 111},
	  {"IU", 75},
	  {"IV", 92},
	  {"IW", 78},
	  {"IX", 69},
	  {"IY", 36},
	  {"IZ", 75},
	  {"JA", 69},
	  {"JE", 83},
	  {"JI", 41},
	  {"JO", 83},
	  {"JU", 81},
	  {"KA", 81},
	  {"KB", 64},
	  {"KC", 60},
	  {"KD", 55},
	  {"KE", 98},
	  {"KF", 66},
	  {"KG", 54},
	  {"KH", 77},
	  {"KI", 91},
	  {"KJ", 41},
	  {"KK", 37},
	  {"KL", 70},
	  {"KM", 62},
	  {"KN", 87},
	  {"KO", 78},
	  {"KP", 60},
	  {"KQ", 35},
	  {"KR", 58},
	  {"KS", 80},
	  {"KT", 78},
	  {"KU", 68},
	  {"KV", 41},
	  {"KW", 72},
	  {"KY", 67},
	  {"KZ", 10},
	  {"LA", 103},
	  {"LB", 79},
	  {"LC", 75},
	  {"LD", 99},
	  {"LE", 108},
	  {"LF", 89},
	  {"LG", 70},
	  {"LH", 79},
	  {"LI", 104},
	  {"LJ", 71},
	  {"LK", 78},
	  {"LL", 106},
	  {"LM", 82},
	  {"LN", 72},
	  {"LO", 102},
	  {"LP", 77},
	  {"LQ", 47},
	  {"LR", 77},
	  {"LS", 89},
	  {"LT", 93},
	  {"LU", 85},
	  {"LV", 75},
	  {"LW", 82},
	  {"LY", 101},
	  {"LZ", 35},
	  {"MA", 105},
	  {"MB", 86},
	  {"MC", 67},
	  {"MD", 64},
	  {"ME", 107},
	  {"MF", 74},
	  {"MG", 65},
	  {"MH", 79},
	  {"MI", 98},
	  {"MJ", 50},
	  {"MK", 47},
	  {"ML", 68},
	  {"MM", 84},
	  {"MN", 73},
	  {"MO", 100},
	  {"MP", 91},
	  {"MQ", 41},
	  {"MR", 78},
	  {"MS", 89},
	  {"MT", 89},
	  {"MU", 87},
	  {"MV", 52},
	  {"MW", 78},
	  {"MY", 90},
	  {"MZ", 6},
	  {"NA", 103},
	  {"NB", 84},
	  {"NC", 101},
	  {"ND", 114},
	  {"NE", 107},
	  {"NF", 88},
	  {"NG", 110},
	  {"NH", 94},
	  {"NI", 101},
	  {"NJ", 73},
	  {"NK", 84},
	  {"NL", 89},
	  {"NM", 83},
	  {"NN", 88},
	  {"NO", 107},
	  {"NP", 80},
	  {"NQ", 68},
	  {"NR", 77},
	  {"NS", 101},
	  {"NT", 112},
	  {"NU", 83},
	  {"NV", 83},
	  {"NW", 91},
	  {"NX", 57},
	  {"NY", 88},
	  {"NZ", 44},
	  {"OA", 91},
	  {"OB", 90},
	  {"OC", 91},
	  {"OD", 94},
	  {"OE", 82},
	  {"OF", 109},
	  {"OG", 85},
	  {"OH", 92},
	  {"OI", 92},
	  {"OJ", 61},
	  {"OK", 90},
	  {"OL", 100},
	  {"OM", 105},
	  {"ON", 112},
	  {"OO", 101},
	  {"OP", 94},
	  {"OQ", 57},
	  {"OR", 110},
	  {"OS", 101},
	  {"OT", 106},
	  {"OU", 112},
	  {"OV", 95},
	  {"OW", 103},
	  {"OX", 61},
	  {"OY", 83},
	  {"OZ", 56},
	  {"PA", 97},
	  {"PB", 61},
	  {"PC", 57},
	  {"PD", 50},
	  {"PE", 101},
	  {"PF", 61},
	  {"PG", 42},
	  {"PH", 78},
	  {"PI", 92},
	  {"PJ", 39},
	  {"PK", 41},
	  {"PL", 94},
	  {"PM", 60},
	  {"PN", 50},
	  {"PO", 97},
	  {"PP", 90},
	  {"PQ", 29},
	  {"PR", 98},
	  {"PS", 80},
	  {"PT", 87},
	  {"PU", 83},
	  {"PV", 32},
	  {"PW", 67},
	  {"PY", 70},
	  {"PZ", 6},
	  {"QA", 6},
	  {"QU", 89},
	  {"QW", 13},
	  {"RA", 106},
	  {"RB", 86},
	  {"RC", 90},
	  {"RD", 96},
	  {"RE", 115},
	  {"RF", 87},
	  {"RG", 85},
	  {"RH", 92},
	  {"RI", 106},
	  {"RJ", 65},
	  {"RK", 81},
	  {"RL", 89},
	  {"RM", 94},
	  {"RN", 92},
	  {"RO", 107},
	  {"RP", 84},
	  {"RQ", 56},
	  {"RR", 94},
	  {"RS", 103},
	  {"RT", 103},
	  {"RU", 91},
	  {"RV", 80},
	  {"RW", 90},
	  {"RX", 54},
	  {"RY", 96},
	  {"RZ", 46},
	  {"SA", 108},
	  {"SB", 91},
	  {"SC", 95},
	  {"SD", 86},
	  {"SE", 109},
	  {"SF", 91},
	  {"SG", 82},
	  {"SH", 107},
	  {"SI", 105},
	  {"SJ", 70},
	  {"SK", 84},
	  {"SL", 90},
	  {"SM", 93},
	  {"SN", 90},
	  {"SO", 106},
	  {"SP", 96},
	  {"SQ", 71},
	  {"SR", 83},
	  {"SS", 105},
	  {"ST", 112},
	  {"SU", 96},
	  {"SV", 74},
	  {"SW", 97},
	  {"SX", 47},
	  {"SY", 80},
	  {"SZ", 32},
	  {"TA", 106},
	  {"TB", 89},
	  {"TC", 88},
	  {"TD", 85},
	  {"TE", 109},
	  {"TF", 87},
	  {"TG", 77},
	  {"TH", 124},
	  {"TI", 109},
	  {"TJ", 68},
	  {"TK", 71},
	  {"TL", 95},
	  {"TM", 89},
	  {"TN", 83},
	  {"TO", 113},
	  {"TP", 83},
	  {"TQ", 57},
	  {"TR", 99},
	  {"TS", 100},
	  {"TT", 107},
	  {"TU", 95},
	  {"TV", 66},
	  {"TW", 99},
	  {"TY", 93},
	  {"TZ", 56},
	  {"UA", 87},
	  {"UB", 82},
	  {"UC", 91},
	  {"UD", 85},
	  {"UE", 87},
	  {"UF", 74},
	  {"UG", 93},
	  {"UH", 71},
	  {"UI", 87},
	  {"UJ", 49},
	  {"UK", 69},
	  {"UL", 99},
	  {"UM", 86},
	  {"UN", 100},
	  {"UO", 66},
	  {"UP", 91},
	  {"UQ", 40},
	  {"UR", 102},
	  {"US", 102},
	  {"UT", 103},
	  {"UU", 49},
	  {"UV", 60},
	  {"UW", 74},
	  {"UX", 58},
	  {"UY", 58},
	  {"UZ", 65},
	  {"VA", 88},
	  {"VB", 45},
	  {"VC", 45},
	  {"VD", 44},
	  {"VE", 108},
	  {"VF", 43},
	  {"VG", 41},
	  {"VH", 55},
	  {"VI", 93},
	  {"VJ", 23},
	  {"VK", 34},
	  {"VL", 56},
	  {"VM", 39},
	  {"VN", 63},
	  {"VO", 83},
	  {"VP", 42},
	  {"VQ", 10},
	  {"VR", 64},
	  {"VS", 66},
	  {"VT", 56},
	  {"VU", 49},
	  {"VV", 28},
	  {"VW", 61},
	  {"VY", 57},
	  {"WA", 106},
	  {"WB", 66},
	  {"WC", 66},
	  {"WD", 70},
	  {"WE", 100},
	  {"WF", 66},
	  {"WG", 55},
	  {"WH", 105},
	  {"WI", 103},
	  {"WJ", 45},
	  {"WK", 50},
	  {"WL", 71},
	  {"WM", 68},
	  {"WN", 87},
	  {"WO", 97},
	  {"WP", 61},
	  {"WQ", 39},
	  {"WR", 76},
	  {"WS", 80},
	  {"WT", 80},
	  {"WU", 56},
	  {"WV", 51},
	  {"WW", 75},
	  {"WY", 64},
	  {"WZ", 20},
	  {"XA", 69},
	  {"XB", 37},
	  {"XC", 75},
	  {"XD", 31},
	  {"XE", 69},
	  {"XF", 45},
	  {"XG", 16},
	  {"XH", 56},
	  {"XI", 71},
	  {"XJ", 16},
	  {"XK", 16},
	  {"XL", 36},
	  {"XM", 45},
	  {"XN", 32},
	  {"XO", 52},
	  {"XP", 79},
	  {"XQ", 36},
	  {"XR", 33},
	  {"XS", 44},
	  {"XT", 74},
	  {"XU", 46},
	  {"XV", 49},
	  {"XW", 47},
	  {"XX", 43},
	  {"XY", 38},
	  {"YA", 95},
	  {"YB", 85},
	  {"YC", 83},
	  {"YD", 83},
	  {"YE", 91},
	  {"YF", 83},
	  {"YG", 75},
	  {"YH", 88},
	  {"YI", 90},
	  {"YJ", 60},
	  {"YK", 63},
	  {"YL", 80},
	  {"YM", 83},
	  {"YN", 76},
	  {"YO", 102},
	  {"YP", 80},
	  {"YQ", 53},
	  {"YR", 79},
	  {"YS", 93},
	  {"YT", 96},
	  {"YU", 67},
	  {"YV", 62},
	  {"YW", 90},
	  {"YX", 20},
	  {"YY", 70},
	  {"YZ", 36},
	  {"ZA", 60},
	  {"ZB", 29},
	  {"ZC", 27},
	  {"ZD", 35},
	  {"ZE", 77},
	  {"ZF", 25},
	  {"ZG", 6},
	  {"ZH", 51},
	  {"ZI", 63},
	  {"ZJ", 13},
	  {"ZK", 13},
	  {"ZL", 52},
	  {"ZM", 42},
	  {"ZN", 33},
	  {"ZO", 66},
	  {"ZP", 19},
	  {"ZQ", 6},
	  {"ZR", 23},
	  {"ZS", 30},
	  {"ZT", 35},
	  {"ZU", 50},
	  {"ZV", 25},
	  {"ZW", 40},
	  {"ZY", 45},
	  {"ZZ", 55}
	};
	
	StringToIntMap expectedTrigrams;
	StringToIntMap expectedTetragrams;
	StringToIntMap expectedPentagrams;
	
	double GetLetterFrequency(char c)
	{
		return expectedLetters[c];
	}
	
	int GetBigramFrequency(string bigram)
	{
		return expectedBigrams[bigram];
	}
	
	int GetTrigramFrequency(string trigram)
	{
		return expectedTrigrams[trigram];
	}
	
	int GetTetragramFrequency(string tetragram)
	{
		return expectedTetragrams[tetragram];
	}
	
	int GetPentagramFrequency(string pentagram)
	{
		return expectedPentagrams[pentagram];
	}
	
	void PopulateNGrams(string filename, StringToIntMap& m)
	{
		ifstream ifs(filename);
		string line;
		while (getline(ifs, line))
		{
			istringstream iss(line);
			int n;
			string s;
			iss >> s >> n;
			m[s] = n;
		}
	}
	
	void Initialize()
	{
		expectedTrigrams.reserve(8465);
		expectedTetragrams.reserve(66686);
		expectedPentagrams.reserve(263342);
		PopulateNGrams("data/trigrams.txt", expectedTrigrams);
		PopulateNGrams("data/tetragrams.txt", expectedTetragrams);
		PopulateNGrams("data/pentagrams.txt", expectedPentagrams);
	}
}
